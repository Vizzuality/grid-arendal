<HTML>
<HEAD>
<!--JObjectsQuest:OFF; Don't index the content of this file -->

<SCRIPT LANGUAGE="JavaScript">
<!-- hide this script from non-javascript-enabled browsers

var multi=false;

// result page cache
var resPage = null;

// last query result
var resCnt;

// Search form settings
var lastQuery = "";
var currCollection = 1;
var showHighlighted = false;
var showNavTags = false;
var resultLayout = "full";
var maxHits = 30;
var formLayout = "quick";


function PerformSearch( qform )
{
  // load active collection
  if( multi )  {
    LoadCollection( qform );
  }

  /*    
  if( navigator.appName.indexOf( "Netscape" ) != -1 &&
      navigator.appVersion >= "4" )
  {
    document.QuestAgent.setUseCallbacks( false );
  }*/

  collectQueryOptions( qform );
  
  lastQuery = qform.query.value;

  // start search...
  document.QuestAgent.setMaxHits( maxHits );
  var res = document.QuestAgent.startSearch( lastQuery );
  if( res >= -1 )  {
    OnSearchResults( res );
  }
}

function collectQueryOptions( qform )
{
  if( qform.show_highlighted != null )  {
    if( qform.show_highlighted.checked )
      showHighlighted = true;
    else
      showHighlighted = false;
  }

  if( qform.UseNavigationButtons != null )  {
    if( qform.UseNavigationButtons.checked )
      showNavTags = true;
    else
      showNavTags = false;
  }

  if( qform.maxhits != null )  {
    var mh = qform.maxhits.options[ qform.maxhits.selectedIndex ].value;
    maxHits = eval( mh );
  }
  
  if( qform.result_layout != null )  {
    var lind = qform.result_layout.selectedIndex;
    resultLayout = qform.result_layout.options[ lind ].value;
  }
}

function OnSearchResults( res )
{ // Don't change function name

    resCnt = res;
    window.open( "qares02h.htm", "qaview" );
}

function paintSearchResults( doc )
{ // Don't change function name

    if( formLayout == "full" )  {
      printFullSearchForm( doc );
    }
    else if( formLayout == "default" )  {
      printFullSearchForm( doc );
      formLayout = "quick"; // switch to quick search form
    }
    else  {
      printQuickSearchForm( doc );
    }
      
    var res = 0;
    if( resCnt != null )
      res = eval( "" + resCnt.toString() ) - 0;
    
    doc.open();
    
    // check result
    if( resCnt == null )  {
        return;
    }
    else if( res < 0 )  {
        doc.writeln( "<h3>Error occurred.</h3>" );
        doc.writeln( "<pre>" );
        doc.writeln( document.QuestAgent.getLastMessage() );
        doc.writeln( "</pre>" );
    }
    else if( res == 0 )  {
        doc.writeln( "<h3>Nothing found.</h3>" );
        doc.writeln( "<h3>Refine your query and try again.</h3>" );
    }
    else  {
    
        doc.writeln( "<b>", res, " pages found.</b>" );

        doc.writeln( "<ol>" );
        
        // print results
        var i = 0;
        while( res > 0 )
        {
            var loc = document.QuestAgent.getHitLocation( i );
            var title = document.QuestAgent.getHitTitle( i );
            if( title == null )
              title = loc;
            title = "" + title;
            if( title.length == 0 )
              title = loc;
           
            // create link to file
            doc.writeln( 
                "<li> <b><a href=\"javascript:parent.qawin.ShowDocument(", i, ", document.forms[0] );\">", title, "</a></b><br>" );
               // print description if available
            var desc = document.QuestAgent.getHitField( i, "description" );
            if( desc != null )  {
                var jsdesc = "" + desc;
                if( jsdesc.length > 0 && resultLayout == "full" )
                    doc.writeln( jsdesc, "<br>" );
            }

            doc.writeln( 
                "<font color=\"#808080\"> <b>URL:</b> ", loc, "</font>" );

            var len = Math.round( eval( "" + document.QuestAgent.getHitField( i, "length" ) ) / 1024 );
            if( len == 0 )
              len = 1;
            doc.writeln( "<font color=\"#808080\"> - <b>Size:</b> ", len, "K bytes </font>" );

            doc.writeln( " <font color=\"#808080\"> - <b>Score:</b> ",
                document.QuestAgent.getHitField( i, "relevance" ), "%</font>" );

            doc.writeln( "</li><p>" );

            i++;
            res--;
        }

        doc.writeln( "</ol>" );
    }

    // print footer (don't remove the following notice)
    doc.writeln( "<p>&nbsp;</p><p><font size=-1>" );
    doc.writeln( "<i>Search technology by JObjects. (http://www.jobjects.com)</i>" );
    //doc.writeln( "<i>Search technology by <a href='http://www.jobjects.com' target='_blank'>JObjects</a>. (http://www.jobjects.com)</i>" );
    doc.writeln( "</font>" );
    
    doc.close();
	resCnt = null; //jarle
}

function LoadCollection( qform )
{
  if( qform.collection == null )
    return;
    
  var i = qform.collection.selectedIndex + 1;
  document.QuestAgent.loadCollection( i );
  currCollection = i;
}

function ShowDocument( docID, qform )
{
  var loc = document.QuestAgent.getHitLocation( docID );

  collectQueryOptions( qform );
  
  var loc2 = "" + loc.toLowerCase();
  var canHighlight = false;
  if( loc2.indexOf( "http:" ) == 0 )
    canHighlight = false;
  else if( ( loc2.indexOf( ".htm" ) + 4 ) == loc2.length )
    canHighlight = true;
  else if( ( loc2.indexOf( ".html" ) + 5 ) == loc2.length )
    canHighlight = true;
  if( !showHighlighted || canHighlight == false )  {
    window.open( loc, "qaview" );
    //parent.qaview.location = "" + loc;
    return;
  }

  // get keywords used in last query
  var words = document.QuestAgent.getLastQueryKeywords( "body" );
  
  // do we need to show navigation controls?
  var show_nav = showNavTags;

  // highlighting tags can be set here...
  document.QuestAgent.setHighlightingTags( "<font color=red><b>", "</b></font>" );
  
  // navigation tags can be set here...
  document.QuestAgent.setNavigationTags( "<font size=1>&lt;</font>", "<font size=1>&gt;</font>" );

  // discharge cached page
  resPage = null;

  // open document  
  var page = document.QuestAgent.highlightDocument( loc, words, show_nav, "OnPagesReady" );

  if( page == null || page == "" )  {
    // Requested page is not available at this time.
    // Callback function will be invoked when results are available.
    return; 
  }
  else  {
    // Result page is already available.
    resPage = "" + page;
    OnPagesReady();
  }
}

// Function "OnPagesReady" is a callback function (do NOT change its name)
// that receives event from QuestAgent applet that document is available.
function OnPagesReady()
{
  window.open( "qadoc02h.htm#qa_anchor_1", "qaview" );
}

// Print document content
function showHighlightedDocument( doc )
{
  if( resPage != null )
  {
    // page is already available
    doc.open();
    doc.write( resPage );
    doc.close();
    return;
  }

  // get page content from QuestAgent applet...
  
  doc.open();

  // reset page counter (useful is page is reloaded and must be shown again)
  document.QuestAgent.resetPageCounter();
  
  var tmp_page = "";

  // collect page elements
  while( true )
  {
    page = document.QuestAgent.getNextPage();
    if( page == null || page == "" )
        break;

    tmp_page = tmp_page + "" + page;
  }

  if( tmp_page.length > 0)  {
    resPage = tmp_page;
    doc.write( tmp_page );    
  }
  else {
    var the_error_message = "<p><b>Error</b>: " +
      "QuestAgent is unable to highlight request file. Please try again. " +
      "If the problem persists open document with word highlighting turned off.";
    doc.write( the_error_message );
  }

  doc.close();
}

function showFullSearchForm()
{
  formLayout = "full";
  window.open( "main.htm", "qaview" );
}

function showQuickSearchForm()
{
  formLayout = "quick";
  window.open( "main.htm", "qaview" );
}

function printFullSearchForm( doc )
{
  doc.open();

  doc.writeln( "<body onload="top.scrollTo(0,0)" bgcolor=\"#FFFFFF\">" );

  doc.writeln( "<form onSubmit=\"parent.qawin.PerformSearch( this ); return false;\">" );
  doc.writeln( "  <table border=0 width=570 align=center bgcolor=\"#e4e4e4\" bordercolor=\"#c0c0c0\" bordercolorlight=\"#c0c0c0\" bordercolordark=\"#c0c0c0\">" );
  doc.writeln( "    <tr>" );
  doc.writeln( "      <td valign=top colspan=2 bgcolor=\"#000000\">" );
  doc.writeln( "        <div align=center><font color=\"#FFFFFF\" size=\"+1\">Content Search</font></div>" );
  doc.writeln( "      </td>" );
  doc.writeln( "    </tr>" );

/*


  doc.writeln( "    <tr>" );
  doc.writeln( "      <td valign=top><b>Search In</b><font size=\"-1\"><br>" );
  doc.writeln( "        Select content domain for your search.</font></td>" );
  doc.writeln( "      <td valign=top>" );
  doc.writeln( "        <select name=collection>" );

  var ccount = document.QuestAgent.getCollectionCount();
  for( i = 1; i <= ccount; ++i )
  {
    doc.write( "<option value=", i );
    if( currCollection == i )
      doc.write( " selected " );
    doc.writeln( ">" + document.QuestAgent.getCollectionName( i ) );
  }

  doc.writeln( "        </select>" );
  doc.writeln( "      </td>" );
  doc.writeln( "    </tr>" );

*/


  doc.writeln( "    <tr>" );
  doc.writeln( "      <td valign=top> <b>Search For</b><font size=\"-1\"><br>" );
  doc.writeln( "        Enter keywords or boolean expression for your search. The boolean expression " );
  doc.writeln( "        allows \"and\", \"or\", &quot;not&quot; and parenthesis.</font></td>" );
  doc.writeln( "      <td valign=top>" );
  doc.writeln( "        <input type=text name=query size=25 value=\"", lastQuery, "\">" );
  doc.writeln( "        <input type=button name=submit value=\"Search\"" );
  doc.writeln( "               onClick=\"parent.qawin.PerformSearch( this.form )\" >" );
  doc.writeln( "      </td>" );
  doc.writeln( "    </tr>" );
  doc.writeln( "    <tr>" );
  doc.writeln( "      <td valign=top> <b>Return Number </b><font size=\"-1\"><br>" );
  doc.writeln( "        Return how many documents?</font></td>" );
  doc.writeln( "      <td valign=\"top\">" );
  doc.writeln( "        <select name=\"maxhits\">" );
  doc.write( "          <option value=\"200\" " );
  if( maxHits == 200 )
    doc.write( " selected " );
  doc.writeln( ">200</option>" );
  doc.write( "          <option value=\"100\" " );
  if( maxHits == 100 )
    doc.write( " selected " );
  doc.writeln( ">100</option>" );
  doc.write( "          <option value=\"50\" " );
  if( maxHits == 50 )
    doc.write( " selected " );
  doc.writeln( ">50</option>" );
  doc.write( "          <option value=\"25\" " );
  if( maxHits == 25 )
    doc.write( " selected " );
  doc.writeln( ">25</option>" );
  doc.writeln( "        </select>" );
  doc.writeln( "      </td>" );
  doc.writeln( "    </tr>" );
  doc.writeln( "    <tr>" );
  doc.writeln( "      <td valign=top> <b>Return Format </b><font size=\"-1\"><br>" );
  doc.writeln( "        \"Full descriptions\" includes a summary, \"Title only\" does not</font>.</td>" );
  doc.writeln( "      <td valign=top>" );
  doc.writeln( "        <select name=\"result_layout\">" );
  doc.write( "          <option value=\"full\" " );
  if( resultLayout == "full" )
    doc.write( " selected " );
  doc.writeln( ">Full descriptions</option>" );
  doc.write( "          <option value=\"short\" " );
  if( resultLayout == "short" )
    doc.write( " selected " );
  doc.writeln( ">Title only</option>" );
  doc.writeln( "        </select>" );
  doc.writeln( "      </td>" );
  doc.writeln( "    </tr>" );
  doc.writeln( "    <tr>" );
  doc.writeln( "      <td valign=top><b>Keyword Highlighting</b><br>" );
  doc.writeln( "        <font size=\"-1\">If selected, keywords will be emphasized in found documents.</font></td>" );
  doc.writeln( "      <td valign=top>" );
  doc.write( "        <input type=checkbox name=show_highlighted value=on " );
  if( showHighlighted )
    doc.write( " checked " );
  doc.write( "  >" );
  doc.writeln( "        Highlight keywords</td>" );
  doc.writeln( "    </tr>" );
  doc.writeln( "    <tr>" );
  doc.writeln( "      <td valign=top><b>Navigation Controls</b><br>" );
  doc.writeln( "        <font size=\"-1\">If selected, found documents will contain special controls " );
  doc.writeln( "        for navigation among keywords. Useful for finding words in long documents.</font></td>" );
  doc.writeln( "      <td valign=top>" );
  doc.write( "        <input type=checkbox name=\"UseNavigationButtons\" value=on " );
  if( showNavTags )
    doc.write( " checked " );
  doc.write( "  >" );
  doc.writeln( "        Show navigation controls</td>" );
  doc.writeln( "    </tr>" );
  doc.writeln( "  </table>" );
  doc.writeln( "</form>" );

  doc.writeln( "  <center>" );
  doc.write( "  <font size=\"-1\">" );
  doc.write( "  <br><a href=\"javascript:parent.qawin.showQuickSearchForm();\">Show quick search form</a>" );
  doc.write( "  | <a href=\"qatips.htm\">Show search tips</a>" );
  doc.writeln( "  </font>" );
  doc.writeln( "  </center>" );

  //doc.writeln( "</body>" );

  doc.close();
}

function printQuickSearchForm( doc )
{
  doc.open();

  doc.writeln( "<body onload="top.scrollTo(0,0)" bgcolor=white>" );

  doc.writeln( "<FORM onSubmit=\"parent.qawin.PerformSearch( this ); return false;\">" );
  doc.writeln( "  <b>Search:</b> <INPUT TYPE=TEXT NAME=query VALUE=\"", lastQuery, "\" SIZE=25 class=textfield>" );
  doc.writeln( "  <INPUT TYPE=BUTTON onClick=\"parent.qawin.PerformSearch( this.form )\" VALUE=\"Go\" class=button>" );
  doc.write( "  <font size=\"-1\">" );
  //doc.write( "  <br><a href=\"javascript:parent.qawin.showFullSearchForm();\">Show full search form</a>" );
  //doc.write( "  | <a href=\"qatips.htm\">Show search tips</a>" );
  doc.writeln( "  </font>" );
  doc.writeln( "</FORM>" );
  
  doc.close();
}

function onPageLoaded()
{
  parent.qaframeLoaded = true;
  //window.open( "main.htm", "qaview" );
    window.setTimeout("parent.qaview.location.replace('main.htm')",500);//jarle
}

// stop hiding -->
</SCRIPT>
</HEAD>

<body onload="top.scrollTo(0,0)" onLoad="onPageLoaded()" bgcolor="white">
<p>&nbsp;<p>
This page should be placed in a zero-sized frame.

<APPLET
  CODE     = "com.jobjects.quest.agent.HiddenSearchApplet"
  ARCHIVE  = "qagent_h.jar"
  NAME     = "QuestAgent"
  ID       = "QuestAgent"
  WIDTH    = 0
  HEIGHT   = 0
  MAYSCRIPT
>

<PARAM NAME="ParamFile" VALUE="qagent.prm">

<PARAM NAME="js.OnSearchResults" VALUE="OnSearchResults">

<PARAM NAME="js.OnNoLCPage" VALUE="qa_no_js.htm">
<PARAM NAME="js.OnNoLCFrame" VALUE="_top">

</APPLET>

</BODY>
</HTML>
